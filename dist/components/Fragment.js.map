{"version":3,"sources":["../../src/components/Fragment.js"],"names":["Fragment","props","state","context","store","router","id","current","handleChange","bind","visible","unsubscribe","subscribe","isSubscribed","slice","immutable","getState","routerStore","get","idPath","getIn","route","match","indexOf","setState","removed","children","ChildComponent","component","contextTypes","object","propTypes","oneOfType","string","number","array","childContextTypes","shape","bool","routes","isRequired"],"mappings":"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","file":"Fragment.js","sourcesContent":["import React, { Children, Component, PropTypes } from 'react';\n\nclass Fragment extends Component {\n\n    constructor(props, state) {\n\n        super(props, state);\n\n        const { store, router } = this.context;\n        const { id } = this.props;\n\n        this.store = store;\n        this.router = router;\n        this.current = router.current ? `${router.current}:${id}` : id;\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            visible: false\n        };\n\n        this.unsubscribe = store.subscribe(this.handleChange);\n    }\n\n    isSubscribed() {\n        return typeof this.unsubscribe === 'function'\n    }\n\n    getChildContext() {\n\n        let { router } = this.context;\n\n        return { router: { ...router, current: this.current } };\n    }\n\n    componentWillMount() {\n\n        this.handleChange();\n    }\n\n    componentWillUnmount() {\n\n        if (this.unsubscribe) {\n            this.unsubscribe()\n            this.unsubscribe = null\n        }\n    }\n\n    handleChange() {\n\n        if (!this.isSubscribed) return;\n\n        let { slice = 'router', immutable } = this.router;\n        let current = this.current;\n\n        const state = this.store.getState();\n        const { id } = this.props;\n        const routerStore = immutable ? state.get(slice) : state[slice];\n\n        current = current ? current : id;\n\n        if (routerStore) {\n            const idPath = immutable ? routerStore.getIn([ 'route', 'idPath' ]) : routerStore.route.idPath;\n            const match = (`${idPath}:`).indexOf(`${current}:`);\n\n            if (match === 0 && !this.state.visible) {\n                this.setState({\n                    visible: true\n                });\n            } else if (match !== 0 && this.state.visible && !this.removed) {\n                this.setState({\n                    visible: false\n                });\n            }\n        }\n\n    }\n\n    render() {\n\n        const { visible } = this.state;\n        const { children, component: ChildComponent} = this.props;\n\n        if (!visible || this.removed) return null; // eslint-disable-line\n        if (ChildComponent) return <ChildComponent />; // eslint-disable-line\n        if (children) return <div>{children}</div>; // eslint-disable-line\n    }\n}\n\nFragment.contextTypes = {\n    router: PropTypes.object,\n    store: PropTypes.object\n};\n\nFragment.propTypes = {\n    id: PropTypes.oneOfType([\n        PropTypes.string,\n        PropTypes.number\n    ]),\n    children: PropTypes.oneOfType([\n        PropTypes.object,\n        PropTypes.string,\n        PropTypes.array\n    ]),\n    component: PropTypes.object\n};\n\nFragment.childContextTypes = {\n    router: PropTypes.shape({\n        slice: PropTypes.string,\n        immutable: PropTypes.bool,\n        routes: PropTypes.array\n    }).isRequired,\n    store: PropTypes.object\n};\n\nexport default Fragment;\n"]}