{"version":3,"sources":["../../src/components/Fragment.js"],"names":["Fragment","props","state","context","store","router","id","current","handleChange","bind","visible","subscribe","removed","slice","immutable","getState","routerStore","get","idPath","getIn","route","match","indexOf","setState","children","ChildComponent","component","contextTypes","object","propTypes","oneOfType","string","number","array","childContextTypes","shape","bool","routes","isRequired"],"mappings":"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","file":"Fragment.js","sourcesContent":["import React, { Children, Component, PropTypes } from 'react';\n\nclass Fragment extends Component {\n\n    constructor(props, state) {\n\n        super(props, state);\n\n        const { store, router } = this.context;\n        const { id } = this.props;\n\n        this.store = store;\n        this.router = router;\n        this.current = router.current ? `${router.current}:${id}` : id;\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            visible: false\n        };\n\n        store.subscribe(this.handleChange);\n    }\n\n    getChildContext() {\n\n        let { router } = this.context;\n\n        return { router: { ...router, current: this.current } };\n    }\n\n    componentWillMount() {\n\n        this.handleChange();\n    }\n\n    componentWillUnmount() {\n        this.removed = true;\n    }\n\n    handleChange() {\n\n        let { slice = 'router', immutable } = this.router;\n        let current = this.current;\n\n        const state = this.store.getState();\n        const { id } = this.props;\n        const routerStore = immutable ? state.get(slice) : state[slice];\n\n        current = current ? current : id;\n\n        if (routerStore) {\n            const idPath = immutable ? routerStore.getIn([ 'route', 'idPath' ]) : routerStore.route.idPath;\n            const match = (`${idPath}:`).indexOf(`${current}:`);\n\n            if (match === 0 && !this.state.visible) {\n                this.setState({\n                    visible: true\n                });\n            } else if (match !== 0 && this.state.visible && !this.removed) {\n                this.setState({\n                    visible: false\n                });\n            }\n        }\n\n    }\n\n    render() {\n\n        const { visible } = this.state;\n        const { children, component: ChildComponent} = this.props;\n\n        if (!visible || this.removed) return null; // eslint-disable-line\n        if (ChildComponent) return <ChildComponent />; // eslint-disable-line\n        if (children) return <div>{children}</div>; // eslint-disable-line\n    }\n}\n\nFragment.contextTypes = {\n    router: PropTypes.object,\n    store: PropTypes.object\n};\n\nFragment.propTypes = {\n    id: PropTypes.oneOfType([\n        PropTypes.string,\n        PropTypes.number\n    ]),\n    children: PropTypes.oneOfType([\n        PropTypes.object,\n        PropTypes.string,\n        PropTypes.array\n    ]),\n    component: PropTypes.object\n};\n\nFragment.childContextTypes = {\n    router: PropTypes.shape({\n        slice: PropTypes.string,\n        immutable: PropTypes.bool,\n        routes: PropTypes.array\n    }).isRequired,\n    store: PropTypes.object\n};\n\nexport default Fragment;\n"]}